<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6. Modules &mdash; PyUNIxMD  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. PyUNIxMD utility scripts" href="../utility_scripts.html" />
    <link rel="prev" title="DISH-XF" href="../objects/mqc/shxf.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../unixmd.html" class="icon icon-home">
            PyUNIxMD
          </a>
              <div class="version">
                21.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. PyUNIxMD Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">3. Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">4. Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objects/main.html">5. PyUNIxMD Objects</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-molecule">molecule.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#molecule.Molecule"><code class="docutils literal notranslate"><span class="pre">Molecule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.adjust_nac"><code class="docutils literal notranslate"><span class="pre">Molecule.adjust_nac()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.backup_bo"><code class="docutils literal notranslate"><span class="pre">Molecule.backup_bo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.get_coefficient"><code class="docutils literal notranslate"><span class="pre">Molecule.get_coefficient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.get_nacme"><code class="docutils literal notranslate"><span class="pre">Molecule.get_nacme()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.get_nr_electrons"><code class="docutils literal notranslate"><span class="pre">Molecule.get_nr_electrons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.print_init"><code class="docutils literal notranslate"><span class="pre">Molecule.print_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.read_geometry"><code class="docutils literal notranslate"><span class="pre">Molecule.read_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.reset_bo"><code class="docutils literal notranslate"><span class="pre">Molecule.reset_bo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule.Molecule.update_kinetic"><code class="docutils literal notranslate"><span class="pre">Molecule.update_kinetic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#molecule.State"><code class="docutils literal notranslate"><span class="pre">State</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-thermostat">thermostat.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#thermostat.Berendsen"><code class="docutils literal notranslate"><span class="pre">Berendsen</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermostat.Berendsen.print_init"><code class="docutils literal notranslate"><span class="pre">Berendsen.print_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermostat.Berendsen.run"><code class="docutils literal notranslate"><span class="pre">Berendsen.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#thermostat.NHC"><code class="docutils literal notranslate"><span class="pre">NHC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermostat.NHC.print_init"><code class="docutils literal notranslate"><span class="pre">NHC.print_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermostat.NHC.run"><code class="docutils literal notranslate"><span class="pre">NHC.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#thermostat.Rescale1"><code class="docutils literal notranslate"><span class="pre">Rescale1</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermostat.Rescale1.print_init"><code class="docutils literal notranslate"><span class="pre">Rescale1.print_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermostat.Rescale1.run"><code class="docutils literal notranslate"><span class="pre">Rescale1.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#thermostat.Rescale2"><code class="docutils literal notranslate"><span class="pre">Rescale2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermostat.Rescale2.print_init"><code class="docutils literal notranslate"><span class="pre">Rescale2.print_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermostat.Rescale2.run"><code class="docutils literal notranslate"><span class="pre">Rescale2.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#thermostat.Thermostat"><code class="docutils literal notranslate"><span class="pre">Thermostat</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#qm">qm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-qm.qm_calculator">qm_calculator.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#qm.qm_calculator.QM_calculator"><code class="docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#columbus">columbus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.columbus.columbus">columbus.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.columbus.colbasis">colbasis.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.columbus.casscf">casscf.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.columbus.mrci">mrci.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dftbplus">dftbplus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.dftbplus.dftbplus">dftbplus.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.dftbplus.dftbpar">dftbpar.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.dftbplus.dftb">dftb.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.dftbplus.ssr">ssr.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gaussian09">gaussian09</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.gaussian09.gaussian09">gaussian09.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.gaussian09.dft">dft.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#molpro">molpro</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.molpro.molpro">molpro.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">casscf.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qchem">qchem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.qchem.qchem">qchem.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">dft.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#terachem">terachem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.terachem.terachem">terachem.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">ssr.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#turbomole">turbomole</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.turbomole.turbomole">turbomole.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">dft.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#model">model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.model.model">model.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.model.sac">sac.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.model.dac">dac.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.model.ecr">ecr.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.model.dag">dag.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-qm.model.shin_metiu">shin_metiu.py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mm">mm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-mm.mm_calculator">mm_calculator.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mm.mm_calculator.MM_calculator"><code class="docutils literal notranslate"><span class="pre">MM_calculator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mm.tinker">tinker.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mm.tinker.Tinker"><code class="docutils literal notranslate"><span class="pre">Tinker</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mqc">mqc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-mqc.mqc">mqc.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mqc.mqc.MQC"><code class="docutils literal notranslate"><span class="pre">MQC</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mqc.bomd">bomd.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mqc.bomd.BOMD"><code class="docutils literal notranslate"><span class="pre">BOMD</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mqc.ct">ct.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mqc.ct.CT"><code class="docutils literal notranslate"><span class="pre">CT</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mqc.eh">eh.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mqc.eh.Eh"><code class="docutils literal notranslate"><span class="pre">Eh</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mqc.sh">sh.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mqc.sh.SH"><code class="docutils literal notranslate"><span class="pre">SH</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mqc.shxf">shxf.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mqc.shxf.Auxiliary_Molecule"><code class="docutils literal notranslate"><span class="pre">Auxiliary_Molecule</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mqc.shxf.SHXF"><code class="docutils literal notranslate"><span class="pre">SHXF</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utility_scripts.html">7. PyUNIxMD utility scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/main.html">8. References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../unixmd.html">PyUNIxMD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../unixmd.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">6. </span>Modules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/main.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="modules">
<h1><span class="section-number">6. </span>Modules<a class="headerlink" href="#modules" title="Permalink to this heading"></a></h1>
<section id="module-molecule">
<span id="molecule-py"></span><h2>molecule.py<a class="headerlink" href="#module-molecule" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="molecule.Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">molecule.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nstates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_qmmm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms_mm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'angs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_vel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for a molecule object including State objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<em>string</em>) – A string containing atomic positions and velocities</p></li>
<li><p><strong>ndim</strong> (<em>integer</em>) – Dimension of space</p></li>
<li><p><strong>nstates</strong> (<em>integer</em>) – Number of BO states</p></li>
<li><p><strong>l_qmmm</strong> (<em>boolean</em>) – Use the QM/MM scheme</p></li>
<li><p><strong>natoms_mm</strong> (<em>integer</em>) – Number of atoms in the MM region</p></li>
<li><p><strong>ndof</strong> (<em>integer</em>) – Degrees of freedom (if model is False, the molecular DoF is given.)</p></li>
<li><p><strong>unit_pos</strong> (<em>string</em>) – Unit of atomic positions</p></li>
<li><p><strong>unit_vel</strong> (<em>string</em>) – Unit of atomic velocities</p></li>
<li><p><strong>charge</strong> (<em>double</em>) – Total charge of the system</p></li>
<li><p><strong>l_model</strong> (<em>boolean</em>) – Is the system a model system?</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.adjust_nac">
<span class="sig-name descname"><span class="pre">adjust_nac</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.adjust_nac" title="Permalink to this definition"></a></dt>
<dd><p>Adjust phase of nonadiabatic couplings</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.backup_bo">
<span class="sig-name descname"><span class="pre">backup_bo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.backup_bo" title="Permalink to this definition"></a></dt>
<dd><p>Backup BO energies and nonadiabatic couplings</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_coefficient">
<span class="sig-name descname"><span class="pre">get_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.get_coefficient" title="Permalink to this definition"></a></dt>
<dd><p>Get initial coefficient</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coef</strong> (<em>double</em><em>, </em><em>list</em><em> or </em><em>complex</em><em>, </em><em>list</em>) – Initial BO coefficient</p></li>
<li><p><strong>istate</strong> (<em>integer</em>) – Initial adiabatic state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_nacme">
<span class="sig-name descname"><span class="pre">get_nacme</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.get_nacme" title="Permalink to this definition"></a></dt>
<dd><p>Get NACME from nonadiabatic couplings</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_nr_electrons">
<span class="sig-name descname"><span class="pre">get_nr_electrons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.get_nr_electrons" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of electrons</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Print initial information about molecule.py</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.read_geometry">
<span class="sig-name descname"><span class="pre">read_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.read_geometry" title="Permalink to this definition"></a></dt>
<dd><p>Routine to read the geometry in extended xyz format.</p>
<p>Example:</p>
<p>geometry = ‘’’</p>
<blockquote>
<div><p>2</p>
<p>Hydrogen</p>
<p>H 0.0 0.0 0.0 0.0 0.0 0.0</p>
<p>H 0.0 0.0 0.8 0.0 0.0 0.0</p>
<p>‘’’</p>
</div></blockquote>
<p>self.read_geometry(geometry)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geometry</strong> (<em>string</em>) – Cartesian coordinates for position and initial velocity in the extended xyz format</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.reset_bo">
<span class="sig-name descname"><span class="pre">reset_bo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calc_coupling</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.reset_bo" title="Permalink to this definition"></a></dt>
<dd><p>Reset BO energies, forces and nonadiabatic couplings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>calc_coupling</strong> (<em>boolean</em>) – Check whether the dynamics includes coupling calculation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.update_kinetic">
<span class="sig-name descname"><span class="pre">update_kinetic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molecule.Molecule.update_kinetic" title="Permalink to this definition"></a></dt>
<dd><p>Get kinetic energy</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="molecule.State">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">molecule.</span></span><span class="sig-name descname"><span class="pre">State</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molecule.State" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for BO states</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ndim</strong> (<em>integer</em>) – Dimension of space</p></li>
<li><p><strong>nat</strong> (<em>integer</em>) – Number of atoms</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thermostat">
<span id="thermostat-py"></span><h2>thermostat.py<a class="headerlink" href="#module-thermostat" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thermostat.Berendsen">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermostat.</span></span><span class="sig-name descname"><span class="pre">Berendsen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Berendsen" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#thermostat.Thermostat" title="thermostat.Thermostat"><code class="xref py py-class docutils literal notranslate"><span class="pre">Thermostat</span></code></a></p>
<p>Rescale the velocities by Berendsen thermostat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>double</em>) – Target temperature (K) of the thermostat</p></li>
<li><p><strong>coupling_parameter</strong> (<em>double</em>) – The characteristic tims to damp temperature toward target temperature.</p></li>
<li><p><strong>coupling_strength</strong> (<em>double</em>) – Dimensionless coupling strength for the thermostat</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermostat.Berendsen.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Berendsen.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Print information about thermostat</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermostat.Berendsen.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">md</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Berendsen.run" title="Permalink to this definition"></a></dt>
<dd><p>Control the temperature</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>md</strong> (<em>object</em>) – MQC object, the MD theory</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermostat.NHC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermostat.</span></span><span class="sig-name descname"><span class="pre">NHC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.NHC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#thermostat.Thermostat" title="thermostat.Thermostat"><code class="xref py py-class docutils literal notranslate"><span class="pre">Thermostat</span></code></a></p>
<p>Rescale the velocities by Nose-Hoover chain thermostat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>double</em>) – Target temperature (K) of the thermostat</p></li>
<li><p><strong>coupling_strength</strong> (<em>double</em>) – Coupling strength</p></li>
<li><p><strong>time_scale</strong> (<em>double</em>) – Coupling time scale</p></li>
<li><p><strong>chain_length</strong> (<em>integer</em>) – The number of particles in the NHC chain</p></li>
<li><p><strong>order</strong> (<em>integer</em>) – The order of evolution operator</p></li>
<li><p><strong>nsteps</strong> (<em>integer</em>) – NHC propagation step</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermostat.NHC.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.NHC.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Print information about thermostat</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermostat.NHC.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">md</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.NHC.run" title="Permalink to this definition"></a></dt>
<dd><p>Control the temperature</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>md</strong> (<em>object</em>) – MQC object, the MD theory</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermostat.Rescale1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermostat.</span></span><span class="sig-name descname"><span class="pre">Rescale1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Rescale1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#thermostat.Thermostat" title="thermostat.Thermostat"><code class="xref py py-class docutils literal notranslate"><span class="pre">Thermostat</span></code></a></p>
<p>Rescale the velocities in a given period</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>double</em>) – Target temperature (K) of the thermostat</p></li>
<li><p><strong>nrescale</strong> (<em>integer</em>) – The number of MD steps between rescalings</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermostat.Rescale1.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Rescale1.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Print information about thermostat</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermostat.Rescale1.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">md</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Rescale1.run" title="Permalink to this definition"></a></dt>
<dd><p>Control the temperature</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>md</strong> (<em>object</em>) – MQC object, the MD theory</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermostat.Rescale2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermostat.</span></span><span class="sig-name descname"><span class="pre">Rescale2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtemperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Rescale2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#thermostat.Thermostat" title="thermostat.Thermostat"><code class="xref py py-class docutils literal notranslate"><span class="pre">Thermostat</span></code></a></p>
<p>Rescale the velocities when the temerature is out of a given range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>double</em>) – Target temperature (K) of the thermostat</p></li>
<li><p><strong>dtemperature</strong> (<em>double</em>) – Threshold temperature difference (K)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermostat.Rescale2.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Rescale2.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Print information about thermostat</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermostat.Rescale2.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">md</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Rescale2.run" title="Permalink to this definition"></a></dt>
<dd><p>Control the temperature</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>md</strong> (<em>object</em>) – MQC object, the MD theory</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermostat.Thermostat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermostat.</span></span><span class="sig-name descname"><span class="pre">Thermostat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermostat.Thermostat" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Object class for a thermostat. The type of given thermostat is classified by its subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>double</em>) – Target temperature (K) of the thermostat</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="qm">
<span id="module-qm"></span><h2>qm<a class="headerlink" href="#qm" title="Permalink to this heading"></a></h2>
<section id="module-qm.qm_calculator">
<span id="qm-calculator-py"></span><h3>qm_calculator.py<a class="headerlink" href="#module-qm.qm_calculator" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="qm.qm_calculator.QM_calculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.qm_calculator.</span></span><span class="sig-name descname"><span class="pre">QM_calculator</span></span><a class="headerlink" href="#qm.qm_calculator.QM_calculator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for quantum mechanics calculator such as QM, ML, etc</p>
<dl class="py method">
<dt class="sig sig-object py" id="qm.qm_calculator.QM_calculator.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qm_calculator.QM_calculator.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Make scratch directory and copy geometry file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.qm_calculator.QM_calculator.move_dir">
<span class="sig-name descname"><span class="pre">move_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qm_calculator.QM_calculator.move_dir" title="Permalink to this definition"></a></dt>
<dd><p>Move to the base directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.qm_calculator.QM_calculator.write_xyz">
<span class="sig-name descname"><span class="pre">write_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qm_calculator.QM_calculator.write_xyz" title="Permalink to this definition"></a></dt>
<dd><p>Make current geometry file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="columbus">
<h3>columbus<a class="headerlink" href="#columbus" title="Permalink to this heading"></a></h3>
<section id="module-qm.columbus.columbus">
<span id="columbus-py"></span><h4>columbus.py<a class="headerlink" href="#module-qm.columbus.columbus" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.columbus.columbus.Columbus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.columbus.columbus.</span></span><span class="sig-name descname"><span class="pre">Columbus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qm_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.columbus.Columbus" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qm_calculator.QM_calculator" title="qm.qm_calculator.QM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></p>
<p>Class for common parts of Columbus</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>integer</em>) – Allocatable memory in the calculations</p></li>
<li><p><strong>qm_path</strong> (<em>string</em>) – Path for QM binary</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Columbus</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-qm.columbus.colbasis">
<span id="colbasis-py"></span><h4>colbasis.py<a class="headerlink" href="#module-qm.columbus.colbasis" title="Permalink to this heading"></a></h4>
</section>
<section id="module-qm.columbus.casscf">
<span id="casscf-py"></span><h4>casscf.py<a class="headerlink" href="#module-qm.columbus.casscf" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.columbus.casscf.CASSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.columbus.casscf.</span></span><span class="sig-name descname"><span class="pre">CASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'6-31g*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./mocoef'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcscf_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcscf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpscf_grad_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpscf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_orb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qm_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7.0'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.casscf.CASSCF" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.columbus.columbus.Columbus" title="qm.columbus.columbus.Columbus"><code class="xref py py-class docutils literal notranslate"><span class="pre">Columbus</span></code></a></p>
<p>Class for CASSCF method of Columbus</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>integer</em>) – Allocatable memory in the calculations</p></li>
<li><p><strong>guess</strong> (<em>string</em>) – Initial guess for (SA-)CASSCF method</p></li>
<li><p><strong>guess_file</strong> (<em>string</em>) – Initial guess file</p></li>
<li><p><strong>scf_en_tol</strong> (<em>integer</em>) – Energy convergence for SCF iterations</p></li>
<li><p><strong>scf_max_iter</strong> (<em>integer</em>) – Maximum number of SCF iterations</p></li>
<li><p><strong>mcscf_en_tol</strong> (<em>integer</em>) – Energy convergence for (SA-)CASSCF iterations</p></li>
<li><p><strong>mcscf_max_iter</strong> (<em>integer</em>) – Maximum number of (SA-)CASSCF iterations</p></li>
<li><p><strong>state_avg</strong> (<em>integer</em>) – Number of states to be averaged for (SA-)CASSCF</p></li>
<li><p><strong>cpscf_grad_tol</strong> (<em>integer</em>) – Gradient tolerance for CP-CASSCF equations</p></li>
<li><p><strong>cpscf_max_iter</strong> (<em>integer</em>) – Maximum number of iterations for CP-CASSCF equations</p></li>
<li><p><strong>active_elec</strong> (<em>integer</em>) – Number of electrons in active space</p></li>
<li><p><strong>active_orb</strong> (<em>integer</em>) – Number of orbitals in active space</p></li>
<li><p><strong>qm_path</strong> (<em>string</em>) – Path for QM binary</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Columbus</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.casscf.CASSCF.copy_files">
<span class="sig-name descname"><span class="pre">copy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.casscf.CASSCF.copy_files" title="Permalink to this definition"></a></dt>
<dd><p>Copy necessary scratch files in previous step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.casscf.CASSCF.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.casscf.CASSCF.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.casscf.CASSCF.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.casscf.CASSCF.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from CASSCF method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.casscf.CASSCF.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.casscf.CASSCF.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate Columbus input files: geom, prepin, stdin, mcscfin, transmomin, etc</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.casscf.CASSCF.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.casscf.CASSCF.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run CASSCF calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qm.columbus.mrci">
<span id="mrci-py"></span><h4>mrci.py<a class="headerlink" href="#module-qm.columbus.mrci" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.columbus.mrci.MRCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.columbus.mrci.</span></span><span class="sig-name descname"><span class="pre">MRCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'6-31g*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./mocoef'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcscf_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcscf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mrci_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mrci_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_orb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_core_orb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_virt_orb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpscf_grad_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpscf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qm_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7.0'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.mrci.MRCI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.columbus.columbus.Columbus" title="qm.columbus.columbus.Columbus"><code class="xref py py-class docutils literal notranslate"><span class="pre">Columbus</span></code></a></p>
<p>Class for MRCI method of Columbus program</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>integer</em>) – Allocatable memory in the calculations</p></li>
<li><p><strong>guess</strong> (<em>string</em>) – Initial guess for MRCI method</p></li>
<li><p><strong>guess_file</strong> (<em>string</em>) – Initial guess file</p></li>
<li><p><strong>scf_en_tol</strong> (<em>integer</em>) – Energy convergence for SCF iterations</p></li>
<li><p><strong>scf_max_iter</strong> (<em>integer</em>) – Maximum number of SCF iterations</p></li>
<li><p><strong>mcscf_en_tol</strong> (<em>integer</em>) – Energy convergence for (SA-)CASSCF iterations</p></li>
<li><p><strong>mcscf_max_iter</strong> (<em>integer</em>) – Maximum number of (SA-)CASSCF iterations</p></li>
<li><p><strong>mrci_en_tol</strong> (<em>integer</em>) – Energy convergence for MRCI iterations</p></li>
<li><p><strong>mrci_max_iter</strong> (<em>integer</em>) – Maximum number of MRCI iterations</p></li>
<li><p><strong>state_avg</strong> (<em>integer</em>) – Number of states to be averaged for (SA-)CASSCF and MRCI</p></li>
<li><p><strong>active_elec</strong> (<em>integer</em>) – Number of electrons in active space</p></li>
<li><p><strong>active_orb</strong> (<em>integer</em>) – Number of orbitals in active space</p></li>
<li><p><strong>frozen_core_orb</strong> (<em>integer</em>) – Number of frozen core orbitals in doubly occupied space</p></li>
<li><p><strong>frozen_virt_orb</strong> (<em>integer</em>) – Number of frozen virtual orbitals from the highest unoccupied space</p></li>
<li><p><strong>cpscf_grad_tol</strong> (<em>integer</em>) – Gradient tolerance for CP-MRCI equations</p></li>
<li><p><strong>cpscf_max_iter</strong> (<em>integer</em>) – Maximum number of iterations for CP-MRCI equations</p></li>
<li><p><strong>qm_path</strong> (<em>string</em>) – Path for QM binary</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Columbus program</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.mrci.MRCI.copy_files">
<span class="sig-name descname"><span class="pre">copy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.mrci.MRCI.copy_files" title="Permalink to this definition"></a></dt>
<dd><p>Copy necessary scratch files in previous step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.mrci.MRCI.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.mrci.MRCI.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.mrci.MRCI.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.mrci.MRCI.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from CASSCF method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.mrci.MRCI.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.mrci.MRCI.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate Columbus input files: geom, prepin, stdin, mcscfin, transmomin, etc</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.columbus.mrci.MRCI.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.columbus.mrci.MRCI.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run MRCI calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="dftbplus">
<h3>dftbplus<a class="headerlink" href="#dftbplus" title="Permalink to this heading"></a></h3>
<section id="module-qm.dftbplus.dftbplus">
<span id="dftbplus-py"></span><h4>dftbplus.py<a class="headerlink" href="#module-qm.dftbplus.dftbplus" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.dftbplus.dftbplus.DFTBplus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.dftbplus.dftbplus.</span></span><span class="sig-name descname"><span class="pre">DFTBplus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sk_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">install_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.dftbplus.DFTBplus" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qm_calculator.QM_calculator" title="qm.qm_calculator.QM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></p>
<p>Class for common parts of DFTB+</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>sk_path</strong> (<em>string</em>) – Path for Slater-Koster files</p></li>
<li><p><strong>install_path</strong> (<em>string</em>) – Path for DFTB+ install directory</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of DFTB+</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-qm.dftbplus.dftbpar">
<span id="dftbpar-py"></span><h4>dftbpar.py<a class="headerlink" href="#module-qm.dftbplus.dftbpar" title="Permalink to this heading"></a></h4>
</section>
<section id="module-qm.dftbplus.dftb">
<span id="dftb-py"></span><h4>dftb.py<a class="headerlink" href="#module-qm.dftbplus.dftb" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.dftbplus.dftb.DFTB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.dftbplus.dftb.</span></span><span class="sig-name descname"><span class="pre">DFTB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_scc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scc_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scc_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_onsite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_range_sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MatrixBased'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_spin_pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unpaired_elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./charges.bin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Broyden'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'singlet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sk_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">install_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'20.1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.dftb.DFTB" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.dftbplus.dftbplus.DFTBplus" title="qm.dftbplus.dftbplus.DFTBplus"><code class="xref py py-class docutils literal notranslate"><span class="pre">DFTBplus</span></code></a></p>
<p>Class for (TD)DFTB method of DFTB+</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>l_scc</strong> (<em>boolean</em>) – Include self-consistent charge (SCC) scheme</p></li>
<li><p><strong>scc_tol</strong> (<em>double</em>) – Stopping criteria for the SCC iterations</p></li>
<li><p><strong>scc_max_iter</strong> (<em>integer</em>) – Maximum number of SCC iterations</p></li>
<li><p><strong>l_onsite</strong> (<em>boolean</em>) – Include onsite correction to SCC term</p></li>
<li><p><strong>l_range_sep</strong> (<em>boolean</em>) – Include long-range corrected functional</p></li>
<li><p><strong>lc_method</strong> (<em>string</em>) – Algorithms for LC-DFTB</p></li>
<li><p><strong>l_spin_pol</strong> (<em>boolean</em>) – Include spin-polarisation scheme</p></li>
<li><p><strong>unpaired_elec</strong> (<em>double</em>) – Number of unpaired electrons</p></li>
<li><p><strong>guess</strong> (<em>string</em>) – Initial guess method for SCC scheme</p></li>
<li><p><strong>guess_file</strong> (<em>string</em>) – Initial guess file for charges</p></li>
<li><p><strong>elec_temp</strong> (<em>double</em>) – Electronic temperature in Fermi-Dirac scheme</p></li>
<li><p><strong>mixer</strong> (<em>string</em>) – Charge mixing method used in DFTB</p></li>
<li><p><strong>ex_symmetry</strong> (<em>string</em>) – Symmetry of excited state in TDDFTB</p></li>
<li><p><strong>e_window</strong> (<em>double</em>) – Energy window for TDDFTB. Increases efficiency of NACME calculation.</p></li>
<li><p><strong>k_point</strong> (<em>integer</em><em>,</em><em>list</em>) – Number of k-point samplings</p></li>
<li><p><strong>l_periodic</strong> (<em>boolean</em>) – Use periodicity in the calculations</p></li>
<li><p><strong>cell_length</strong> (<em>double</em><em>,</em><em>list</em>) – The lattice vectors of periodic unit cell</p></li>
<li><p><strong>sk_path</strong> (<em>string</em>) – Path for Slater-Koster files</p></li>
<li><p><strong>install_path</strong> (<em>string</em>) – Path for DFTB+ install directory</p></li>
<li><p><strong>mpi</strong> (<em>boolean</em>) – Use MPI parallelization</p></li>
<li><p><strong>mpi_path</strong> (<em>string</em>) – Path for MPI binary</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of DFTB+</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.dftb.DFTB.CI_overlap">
<span class="sig-name descname"><span class="pre">CI_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.dftb.DFTB.CI_overlap" title="Permalink to this definition"></a></dt>
<dd><p>Read the necessary files and calculate NACME from tdnac.c routine,
note that only reading of several files is required in this method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.dftb.DFTB.copy_files">
<span class="sig-name descname"><span class="pre">copy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.dftb.DFTB.copy_files" title="Permalink to this definition"></a></dt>
<dd><p>Copy necessary scratch files in previous step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.dftb.DFTB.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.dftb.DFTB.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.dftb.DFTB.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.dftb.DFTB.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from (TD)DFTB method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.dftb.DFTB.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.dftb.DFTB.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate DFTB+ input files: geometry.gen, dftb_in.hsd</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.dftb.DFTB.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.dftb.DFTB.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run (TD)DFTB calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qm.dftbplus.ssr">
<span id="ssr-py"></span><h4>ssr.py<a class="headerlink" href="#module-qm.dftbplus.ssr" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.dftbplus.ssr.SSR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.dftbplus.ssr.</span></span><span class="sig-name descname"><span class="pre">SSR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_scc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scc_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scc_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_onsite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_range_sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MatrixBased'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./eigenvec.bin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_state_interactions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tuning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpreks_grad_alg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pcg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpreks_grad_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sk_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">install_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'20.1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.ssr.SSR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.dftbplus.dftbplus.DFTBplus" title="qm.dftbplus.dftbplus.DFTBplus"><code class="xref py py-class docutils literal notranslate"><span class="pre">DFTBplus</span></code></a></p>
<p>Class for SSR method of DFTB+</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>l_scc</strong> (<em>boolean</em>) – Include self-consistent charge (SCC) scheme</p></li>
<li><p><strong>scc_tol</strong> (<em>double</em>) – Stopping criteria for the SCC iterations</p></li>
<li><p><strong>scc_max_iter</strong> (<em>integer</em>) – Maximum number of SCC iterations</p></li>
<li><p><strong>l_onsite</strong> (<em>boolean</em>) – Include onsite correction to SCC term</p></li>
<li><p><strong>l_range_sep</strong> (<em>boolean</em>) – Include long-range corrected functional</p></li>
<li><p><strong>lc_method</strong> (<em>string</em>) – Algorithms for LC-DFTB</p></li>
<li><p><strong>active_space</strong> (<em>integer</em>) – Active space for DFTB/SSR calculation</p></li>
<li><p><strong>guess</strong> (<em>string</em>) – Initial guess method for SCC scheme</p></li>
<li><p><strong>guess_file</strong> (<em>string</em>) – Initial guess file for eigenvetors</p></li>
<li><p><strong>l_state_interactions</strong> (<em>boolean</em>) – Include state-interaction terms to SA-REKS</p></li>
<li><p><strong>shift</strong> (<em>double</em>) – Level shifting value in SCC iterations</p></li>
<li><p><strong>tuning</strong> (<em>double</em><em>,</em><em>list</em>) – Scaling factor for atomic spin constants</p></li>
<li><p><strong>cpreks_grad_alg</strong> (<em>string</em>) – Algorithms used in CP-REKS equations</p></li>
<li><p><strong>cpreks_grad_tol</strong> (<em>double</em>) – Tolerance used in the conjugate-gradient based algorithms</p></li>
<li><p><strong>l_save_memory</strong> (<em>boolean</em>) – Save memory in cache used in CP-REKS equations</p></li>
<li><p><strong>embedding</strong> (<em>string</em>) – Charge-charge embedding options</p></li>
<li><p><strong>l_periodic</strong> (<em>boolean</em>) – Use periodicity in the calculations</p></li>
<li><p><strong>cell_length</strong> (<em>double</em><em>,</em><em>list</em>) – The lattice vectors of periodic unit cell</p></li>
<li><p><strong>sk_path</strong> (<em>string</em>) – Path for Slater-Koster files</p></li>
<li><p><strong>install_path</strong> (<em>string</em>) – Path for DFTB+ install directory</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of DFTB+</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.ssr.SSR.copy_files">
<span class="sig-name descname"><span class="pre">copy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.ssr.SSR.copy_files" title="Permalink to this definition"></a></dt>
<dd><p>Copy necessary scratch files in previous step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.ssr.SSR.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.ssr.SSR.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.ssr.SSR.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.ssr.SSR.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from SSR method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.ssr.SSR.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.ssr.SSR.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate DFTB+ input files: geometry.gen, dftb_in.hsd</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.dftbplus.ssr.SSR.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.dftbplus.ssr.SSR.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run SSR calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="gaussian09">
<h3>gaussian09<a class="headerlink" href="#gaussian09" title="Permalink to this heading"></a></h3>
<section id="module-qm.gaussian09.gaussian09">
<span id="gaussian09-py"></span><h4>gaussian09.py<a class="headerlink" href="#module-qm.gaussian09.gaussian09" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.gaussian09.gaussian09.Gaussian09">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.gaussian09.gaussian09.</span></span><span class="sig-name descname"><span class="pre">Gaussian09</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.gaussian09.Gaussian09" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qm_calculator.QM_calculator" title="qm.qm_calculator.QM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></p>
<p>Class for common parts of Gaussian 09</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>string</em>) – Allocatable memory</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>root_path</strong> (<em>string</em>) – Path for Gaussian 09 root directory</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Gaussian 09</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-qm.gaussian09.dft">
<span id="dft-py"></span><h4>dft.py<a class="headerlink" href="#module-qm.gaussian09.dft" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.gaussian09.dft.</span></span><span class="sig-name descname"><span class="pre">DFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1gb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BLYP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'STO-3G'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Harris'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./g09.chk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Revision</span> <span class="pre">A.02'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.gaussian09.gaussian09.Gaussian09" title="qm.gaussian09.gaussian09.Gaussian09"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian09</span></code></a></p>
<p>Class for the (TD)DFT method of Gaussian 09</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>functional</strong> (<em>string</em>) – Exchange-correlation functional information</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>string</em>) – Allocatable memory</p></li>
<li><p><strong>guess</strong> (<em>string</em>) – Initial guess for SCF iterations</p></li>
<li><p><strong>guess_file</strong> (<em>string</em>) – Initial guess file</p></li>
<li><p><strong>root_path</strong> (<em>string</em>) – Path for Gaussian 09 root directory</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Gaussian 09</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.CI_overlap">
<span class="sig-name descname"><span class="pre">CI_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.CI_overlap" title="Permalink to this definition"></a></dt>
<dd><p>Read the necessary files and calculate NACME from tdnac.c routine
note that only reading of several files is required in this method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.copy_files">
<span class="sig-name descname"><span class="pre">copy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.copy_files" title="Permalink to this definition"></a></dt>
<dd><p>Copy necessary scratch files in previous step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient from (TD)DFT method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate Gaussian 09 input files: g09.inp</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.init_buffer">
<span class="sig-name descname"><span class="pre">init_buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.init_buffer" title="Permalink to this definition"></a></dt>
<dd><p>Initialize buffer variables to get NACME</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.read_ao_overlap">
<span class="sig-name descname"><span class="pre">read_ao_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_rwfdump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_rwf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.read_ao_overlap" title="Permalink to this definition"></a></dt>
<dd><p>Read a rwf file to obtain ao_overlap data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_rwfdump</strong> (<em>string</em>) – The path for rwfdump binary</p></li>
<li><p><strong>fn_rwf</strong> (<em>string</em>) – The name of the rwf file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.read_mo_coef">
<span class="sig-name descname"><span class="pre">read_mo_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_rwfdump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_rwf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.read_mo_coef" title="Permalink to this definition"></a></dt>
<dd><p>Read a rwf file to obtain mo_coef data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_rwfdump</strong> (<em>string</em>) – The path for rwfdump binary</p></li>
<li><p><strong>fn_rwf</strong> (<em>string</em>) – The name of the rwf file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.read_xy_coef">
<span class="sig-name descname"><span class="pre">read_xy_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_rwfdump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_rwf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.read_xy_coef" title="Permalink to this definition"></a></dt>
<dd><p>Read a rwf file to obtain xy_coef data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>path_rwfdump</strong> (<em>string</em>) – The path for rwfdump binary</p></li>
<li><p><strong>fn_rwf</strong> (<em>string</em>) – The name of the rwf file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.gaussian09.dft.DFT.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.gaussian09.dft.DFT.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run (TD)DFT calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="molpro">
<h3>molpro<a class="headerlink" href="#molpro" title="Permalink to this heading"></a></h3>
<section id="module-qm.molpro.molpro">
<span id="molpro-py"></span><h4>molpro.py<a class="headerlink" href="#module-qm.molpro.molpro" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.molpro.molpro.Molpro">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.molpro.molpro.</span></span><span class="sig-name descname"><span class="pre">Molpro</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qm_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.molpro.molpro.Molpro" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qm_calculator.QM_calculator" title="qm.qm_calculator.QM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></p>
<p>Class for common parts of Molpro</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>string</em>) – Allocatable memory in the calculations</p></li>
<li><p><strong>qm_path</strong> (<em>string</em>) – Path for QM binary</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Molpro</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id1">
<h4>casscf.py<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<span class="target" id="module-qm.molpro.casscf"></span><dl class="py class">
<dt class="sig sig-object py" id="qm.molpro.casscf.CASSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.molpro.casscf.</span></span><span class="sig-name descname"><span class="pre">CASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sto-3g'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'500m'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./wf.wfu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_rho_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcscf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcscf_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcscf_grad_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcscf_step_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_orb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpscf_grad_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qm_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2015.1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.molpro.casscf.CASSCF" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.molpro.molpro.Molpro" title="qm.molpro.molpro.Molpro"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molpro</span></code></a></p>
<p>Class for CASSCF method of Molpro</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>string</em>) – Allocatable memory in the calculations</p></li>
<li><p><strong>guess</strong> (<em>string</em>) – Initial guess for (SA-)CASSCF method</p></li>
<li><p><strong>guess_file</strong> (<em>string</em>) – File containing initial guesses for (SA-)CASSCF calculations</p></li>
<li><p><strong>scf_max_iter</strong> (<em>integer</em>) – Maximum number of HF iterations</p></li>
<li><p><strong>scf_en_tol</strong> (<em>double</em>) – Energy convergence threshold for HF iterations</p></li>
<li><p><strong>scf_rho_tol</strong> (<em>double</em>) – Density convergence threshold for HF iterations</p></li>
<li><p><strong>mcscf_max_iter</strong> (<em>integer</em>) – Maximum number of (SA-)CASSCF iterations</p></li>
<li><p><strong>mcscf_en_tol</strong> (<em>double</em>) – Energy convergence threshold for (SA-)CASSCF iterations</p></li>
<li><p><strong>mcscf_grad_tol</strong> (<em>double</em>) – Gradient convergence threshold for (SA-)CASSCF iterations</p></li>
<li><p><strong>mcscf_step_tol</strong> (<em>double</em>) – Step length convergence threshold for (SA-)CASSCF iterations</p></li>
<li><p><strong>active_elec</strong> (<em>integer</em>) – Number of electrons in active space</p></li>
<li><p><strong>active_orb</strong> (<em>integer</em>) – Number of orbitals in active space</p></li>
<li><p><strong>cpscf_grad_tol</strong> (<em>double</em>) – Gradient convergence threshold for CP-CASSCF equations</p></li>
<li><p><strong>qm_path</strong> (<em>string</em>) – Path for QM binary</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Molpro</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.molpro.casscf.CASSCF.copy_files">
<span class="sig-name descname"><span class="pre">copy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.molpro.casscf.CASSCF.copy_files" title="Permalink to this definition"></a></dt>
<dd><p>Copy necessary scratch files in previous step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.molpro.casscf.CASSCF.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.molpro.casscf.CASSCF.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.molpro.casscf.CASSCF.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.molpro.casscf.CASSCF.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from CASSCF method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.molpro.casscf.CASSCF.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.molpro.casscf.CASSCF.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate Molpro input files: molpro.inp</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.molpro.casscf.CASSCF.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.molpro.casscf.CASSCF.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run CASSCF calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="qchem">
<h3>qchem<a class="headerlink" href="#qchem" title="Permalink to this heading"></a></h3>
<section id="module-qm.qchem.qchem">
<span id="qchem-py"></span><h4>qchem.py<a class="headerlink" href="#module-qm.qchem.qchem" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.qchem.qchem.QChem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.qchem.qchem.</span></span><span class="sig-name descname"><span class="pre">QChem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qchem.qchem.QChem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qm_calculator.QM_calculator" title="qm.qm_calculator.QM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></p>
<p>Class for common parts of Q-Chem</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>string</em>) – Allocatable memory in the calculation</p></li>
<li><p><strong>root_path</strong> (<em>string</em>) – Path for Q-Chem root directory</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculation</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Q-Chem</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id2">
<h4>dft.py<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<span class="target" id="module-qm.qchem.dft"></span><dl class="py class">
<dt class="sig sig-object py" id="qm.qchem.dft.DFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.qchem.dft.</span></span><span class="sig-name descname"><span class="pre">DFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sto-3g'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blyp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_wf_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cis_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cis_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpscf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpscf_grad_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'5.2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qchem.dft.DFT" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qchem.qchem.QChem" title="qm.qchem.qchem.QChem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QChem</span></code></a></p>
<p>Class for DFT method of Q-Chem 5.2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>integer</em>) – Allocatable memory in the calculation</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculation</p></li>
<li><p><strong>functional</strong> (<em>string</em>) – Exchange-correlation functional</p></li>
<li><p><strong>scf_max_iter</strong> (<em>integer</em>) – Maximum number of SCF iterations</p></li>
<li><p><strong>scf_wf_tol</strong> (<em>integer</em>) – Wave function convergence for SCF iterations</p></li>
<li><p><strong>cis_max_iter</strong> (<em>integer</em>) – Maximum number of CIS iterations</p></li>
<li><p><strong>cis_en_tol</strong> (<em>integer</em>) – Energy convergence for CIS iterations</p></li>
<li><p><strong>cpscf_max_iter</strong> (<em>integer</em>) – Maximum number of CP iterations</p></li>
<li><p><strong>cpscf_grad_tol</strong> (<em>integer</em>) – Gradient convergence of CP iterations</p></li>
<li><p><strong>root_path</strong> (<em>string</em>) – Path for Q-Chem root directory</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Q-Chem version</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.qchem.dft.DFT.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qchem.dft.DFT.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.qchem.dft.DFT.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qchem.dft.DFT.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from (TD)DFT method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.qchem.dft.DFT.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qchem.dft.DFT.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate Q-Chem input files: qchem.in</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.qchem.dft.DFT.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.qchem.dft.DFT.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run (TD)DFT calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="terachem">
<h3>terachem<a class="headerlink" href="#terachem" title="Permalink to this heading"></a></h3>
<section id="module-qm.terachem.terachem">
<span id="terachem-py"></span><h4>terachem.py<a class="headerlink" href="#module-qm.terachem.terachem" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.terachem.terachem.TeraChem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.terachem.terachem.</span></span><span class="sig-name descname"><span class="pre">TeraChem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">functional</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngpus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.terachem.terachem.TeraChem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qm_calculator.QM_calculator" title="qm.qm_calculator.QM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></p>
<p>Class for common parts of TeraChem</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>functional</strong> (<em>string</em>) – Exchange-correlation functional information</p></li>
<li><p><strong>precision</strong> (<em>string</em>) – Precision in the calculations</p></li>
<li><p><strong>root_path</strong> (<em>string</em>) – Path for TeraChem root directory</p></li>
<li><p><strong>ngpus</strong> (<em>integer</em>) – Number of GPUs</p></li>
<li><p><strong>gpu_id</strong> (<em>integer</em><em>,</em><em>list</em>) – ID of used GPUs</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of TeraChem</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id3">
<h4>ssr.py<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<span class="target" id="module-qm.terachem.ssr"></span><dl class="py class">
<dt class="sig sig-object py" id="qm.terachem.ssr.SSR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.terachem.ssr.</span></span><span class="sig-name descname"><span class="pre">SSR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dynamic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1.93'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sto-3g'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_wf_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dft'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./c0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reks_diis_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reks_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_state_interactions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpreks_grad_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpreks_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.terachem.ssr.SSR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.terachem.terachem.TeraChem" title="qm.terachem.terachem.TeraChem"><code class="xref py py-class docutils literal notranslate"><span class="pre">TeraChem</span></code></a></p>
<p>Class for SSR method of TeraChem</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>functional</strong> (<em>string</em>) – Exchange-correlation functional information</p></li>
<li><p><strong>precision</strong> (<em>string</em>) – Precision in the calculations</p></li>
<li><p><strong>scf_wf_tol</strong> (<em>double</em>) – Wavefunction convergence for SCF iterations</p></li>
<li><p><strong>scf_max_iter</strong> (<em>integer</em>) – Maximum number of SCF iterations</p></li>
<li><p><strong>active_space</strong> (<em>integer</em>) – Active space for SSR calculation</p></li>
<li><p><strong>guess</strong> (<em>string</em>) – Initial guess for REKS SCF iterations</p></li>
<li><p><strong>guess_file</strong> (<em>string</em>) – Initial guess file</p></li>
<li><p><strong>reks_diis_tol</strong> (<em>double</em>) – DIIS error for REKS SCF iterations</p></li>
<li><p><strong>reks_max_iter</strong> (<em>integer</em>) – Maximum number of REKS SCF iterations</p></li>
<li><p><strong>shift</strong> (<em>double</em>) – Level shifting value in REKS SCF iterations</p></li>
<li><p><strong>l_state_interactions</strong> (<em>boolean</em>) – Include state-interaction terms to SA-REKS</p></li>
<li><p><strong>cpreks_grad_tol</strong> (<em>double</em>) – Gradient tolerance for CP-REKS equations</p></li>
<li><p><strong>cpreks_max_iter</strong> (<em>integer</em>) – Maximum number of CP-REKS iterations</p></li>
<li><p><strong>root_path</strong> (<em>string</em>) – Path for TeraChem root directory</p></li>
<li><p><strong>ngpus</strong> (<em>integer</em>) – Number of GPUs</p></li>
<li><p><strong>gpu_id</strong> (<em>integer</em><em>,</em><em>list</em>) – ID of used GPUs</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of TeraChem</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.terachem.ssr.SSR.copy_files">
<span class="sig-name descname"><span class="pre">copy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.terachem.ssr.SSR.copy_files" title="Permalink to this definition"></a></dt>
<dd><p>Copy necessary scratch files in previous step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.terachem.ssr.SSR.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.terachem.ssr.SSR.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.terachem.ssr.SSR.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.terachem.ssr.SSR.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from SSR method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.terachem.ssr.SSR.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.terachem.ssr.SSR.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate TeraChem input files: input.tcin</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.terachem.ssr.SSR.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.terachem.ssr.SSR.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run SSR calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="turbomole">
<h3>turbomole<a class="headerlink" href="#turbomole" title="Permalink to this heading"></a></h3>
<section id="module-qm.turbomole.turbomole">
<span id="turbomole-py"></span><h4>turbomole.py<a class="headerlink" href="#module-qm.turbomole.turbomole" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.turbomole.turbomole.Turbomole">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.turbomole.turbomole.</span></span><span class="sig-name descname"><span class="pre">Turbomole</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">functional</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.turbomole.turbomole.Turbomole" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qm_calculator.QM_calculator" title="qm.qm_calculator.QM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></p>
<p>Class for common parts of Turbomole</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>functional</strong> (<em>string</em>) – Exchange-correlation functional information</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>string</em>) – Allocatable memory in the calculations</p></li>
<li><p><strong>root_path</strong> (<em>string</em>) – Path for Turbomole root directory</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Turbomole</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id4">
<h4>dft.py<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h4>
<span class="target" id="module-qm.turbomole.dft"></span><dl class="py class">
<dt class="sig sig-object py" id="qm.turbomole.dft.DFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.turbomole.dft.</span></span><span class="sig-name descname"><span class="pre">DFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'b-lyp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SV(P)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cis_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cis_en_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'6.4'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.turbomole.dft.DFT" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.turbomole.turbomole.Turbomole" title="qm.turbomole.turbomole.Turbomole"><code class="xref py py-class docutils literal notranslate"><span class="pre">Turbomole</span></code></a></p>
<p>Class for (TD)DFT method of Turbomole</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>functional</strong> (<em>string</em>) – Exchange-correlation functional information</p></li>
<li><p><strong>basis_set</strong> (<em>string</em>) – Basis set information</p></li>
<li><p><strong>memory</strong> (<em>integer</em>) – Allocatable memory in the calculations</p></li>
<li><p><strong>scf_max_iter</strong> (<em>integer</em>) – Maximum number of SCF iterations</p></li>
<li><p><strong>scf_en_tol</strong> (<em>integer</em>) – Energy convergence for SCF iterations</p></li>
<li><p><strong>cis_max_iter</strong> (<em>integer</em>) – Maximum number of CIS iterations</p></li>
<li><p><strong>cis_en_tol</strong> (<em>integer</em>) – Energy convergence for CIS iterations</p></li>
<li><p><strong>root_path</strong> (<em>string</em>) – Path for Turbomole root directory</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Turbomole</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.turbomole.dft.DFT.extract_QM">
<span class="sig-name descname"><span class="pre">extract_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.turbomole.dft.DFT.extract_QM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get BO information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.turbomole.dft.DFT.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.turbomole.dft.DFT.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from (TD)DFT method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.turbomole.dft.DFT.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.turbomole.dft.DFT.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate Turbomole input files: define.in, control, etc</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.turbomole.dft.DFT.run_QM">
<span class="sig-name descname"><span class="pre">run_QM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.turbomole.dft.DFT.run_QM" title="Permalink to this definition"></a></dt>
<dd><p>Run (TD)DFT calculation and save the output files to qm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="model">
<h3>model<a class="headerlink" href="#model" title="Permalink to this heading"></a></h3>
<section id="module-qm.model.model">
<span id="model-py"></span><h4>model.py<a class="headerlink" href="#module-qm.model.model" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.model.model.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.model.model.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.model.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.qm_calculator.QM_calculator" title="qm.qm_calculator.QM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM_calculator</span></code></a></p>
<p>Class for common parts of model calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qm_path</strong> (<em>string</em>) – path for model calculation program</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-qm.model.sac">
<span id="sac-py"></span><h4>sac.py<a class="headerlink" href="#module-qm.model.sac" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.model.sac.SAC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.model.sac.</span></span><span class="sig-name descname"><span class="pre">SAC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.sac.SAC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.model.model.Model" title="qm.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>Class for simple avoided crossing (SAC) model BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>A</strong> (<em>double</em>) – parameter for simple avoided crossing model</p></li>
<li><p><strong>B</strong> (<em>double</em>) – parameter for simple avoided crossing model</p></li>
<li><p><strong>C</strong> (<em>double</em>) – parameter for simple avoided crossing model</p></li>
<li><p><strong>D</strong> (<em>double</em>) – parameter for simple avoided crossing model</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.model.sac.SAC.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.sac.SAC.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from simple avoided crossing model BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – list of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qm.model.dac">
<span id="dac-py"></span><h4>dac.py<a class="headerlink" href="#module-qm.model.dac" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.model.dac.DAC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.model.dac.</span></span><span class="sig-name descname"><span class="pre">DAC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.015</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.dac.DAC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.model.model.Model" title="qm.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>Class for dual avoided crossing (DAC) model BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>E0</strong> (<em>double</em>) – parameter for dual avoided crossing model</p></li>
<li><p><strong>A</strong> (<em>double</em>) – parameter for dual avoided crossing model</p></li>
<li><p><strong>B</strong> (<em>double</em>) – parameter for dual avoided crossing model</p></li>
<li><p><strong>C</strong> (<em>double</em>) – parameter for dual avoided crossing model</p></li>
<li><p><strong>D</strong> (<em>double</em>) – parameter for dual avoided crossing model</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.model.dac.DAC.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.dac.DAC.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from dual avoided crossing model BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – list of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qm.model.ecr">
<span id="ecr-py"></span><h4>ecr.py<a class="headerlink" href="#module-qm.model.ecr" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.model.ecr.ECR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.model.ecr.</span></span><span class="sig-name descname"><span class="pre">ECR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0006</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.ecr.ECR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.model.model.Model" title="qm.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>Class for extended coupling region with reflection (ECR) model BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>A</strong> (<em>double</em>) – parameter for extended coupling region with reflection</p></li>
<li><p><strong>B</strong> (<em>double</em>) – parameter for extended coupling region with reflection</p></li>
<li><p><strong>C</strong> (<em>double</em>) – parameter for extended coupling region with reflection</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.model.ecr.ECR.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.ecr.ECR.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from simple avoided crossing model BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – list of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qm.model.dag">
<span id="dag-py"></span><h4>dag.py<a class="headerlink" href="#module-qm.model.dag" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.model.dag.DAG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.model.dag.</span></span><span class="sig-name descname"><span class="pre">DAG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0006</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.dag.DAG" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.model.model.Model" title="qm.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>Class for double arch geometry (DAG) model BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>A</strong> (<em>double</em>) – parameter for double arch geometry</p></li>
<li><p><strong>B</strong> (<em>double</em>) – parameter for double arch geometry</p></li>
<li><p><strong>C</strong> (<em>double</em>) – parameter for double arch geometry</p></li>
<li><p><strong>D</strong> (<em>double</em>) – parameter for double arch geometry</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.model.dag.DAG.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.dag.DAG.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from double arch geometry model BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – list of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qm.model.shin_metiu">
<span id="shin-metiu-py"></span><h4>shin_metiu.py<a class="headerlink" href="#module-qm.model.shin_metiu" title="Permalink to this heading"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="qm.model.shin_metiu.Shin_Metiu">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qm.model.shin_metiu.</span></span><span class="sig-name descname"><span class="pre">Shin_Metiu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">401</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">19.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.shin_metiu.Shin_Metiu" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qm.model.model.Model" title="qm.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>Class for 1D Shin-Metiu model BO calculation in a real-space grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>nx</strong> (<em>integer</em>) – the number of grid points</p></li>
<li><p><strong>xmin</strong> (<em>double</em>) – lower bound of the 1D space</p></li>
<li><p><strong>xmax</strong> (<em>double</em>) – upper bound of the 1D space</p></li>
<li><p><strong>L</strong> (<em>double</em>) – the distance between two fixed nuclei</p></li>
<li><p><strong>Rc</strong> (<em>double</em>) – the parameter of a moving nucleus</p></li>
<li><p><strong>Rl</strong> (<em>double</em>) – the parameter of a fixed nucleus in the left side</p></li>
<li><p><strong>Rr</strong> (<em>double</em>) – the parameter of a fixed nucleus in the right side</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qm.model.shin_metiu.Shin_Metiu.get_V">
<span class="sig-name descname"><span class="pre">get_V</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xe</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.shin_metiu.Shin_Metiu.get_V" title="Permalink to this definition"></a></dt>
<dd><p>Calculate potential elements of the BO Hamiltonian</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>double</em>) – the nuclear position</p></li>
<li><p><strong>xe</strong> (<em>double</em>) – the electronic position</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.model.shin_metiu.Shin_Metiu.get_dV">
<span class="sig-name descname"><span class="pre">get_dV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xe</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.shin_metiu.Shin_Metiu.get_dV" title="Permalink to this definition"></a></dt>
<dd><p>Calculate del potential elements of the BO Hamiltonian</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>double</em>) – the nuclear position</p></li>
<li><p><strong>xe</strong> (<em>double</em>) – the electronic position</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qm.model.shin_metiu.Shin_Metiu.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qm.model.shin_metiu.Shin_Metiu.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy, gradient and nonadiabatic couplings from Shin-Metiu BO calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – list of BO states for BO calculation</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – time interval</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>
<section id="mm">
<span id="module-mm"></span><h2>mm<a class="headerlink" href="#mm" title="Permalink to this heading"></a></h2>
<section id="module-mm.mm_calculator">
<span id="mm-calculator-py"></span><h3>mm_calculator.py<a class="headerlink" href="#module-mm.mm_calculator" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mm.mm_calculator.MM_calculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mm.mm_calculator.</span></span><span class="sig-name descname"><span class="pre">MM_calculator</span></span><a class="headerlink" href="#mm.mm_calculator.MM_calculator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for molecular mechanics calculator such as MM, model, etc</p>
<dl class="py method">
<dt class="sig sig-object py" id="mm.mm_calculator.MM_calculator.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mm.mm_calculator.MM_calculator.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Make scratch directory and copy geometry file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mm.mm_calculator.MM_calculator.move_dir">
<span class="sig-name descname"><span class="pre">move_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mm.mm_calculator.MM_calculator.move_dir" title="Permalink to this definition"></a></dt>
<dd><p>Move to the base directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mm.tinker">
<span id="tinker-py"></span><h3>tinker.py<a class="headerlink" href="#module-mm.tinker" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mm.tinker.Tinker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mm.tinker.</span></span><span class="sig-name descname"><span class="pre">Tinker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./tinker.xyz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./tinker.key'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthreads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'8.7'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mm.tinker.Tinker" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mm.mm_calculator.MM_calculator" title="mm.mm_calculator.MM_calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">MM_calculator</span></code></a></p>
<p>Class for Tinker</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>scheme</strong> (<em>string</em>) – Type of QM/MM scheme</p></li>
<li><p><strong>embedding</strong> (<em>string</em>) – Charge embedding options</p></li>
<li><p><strong>vdw</strong> (<em>string</em>) – Van der Walls interactions</p></li>
<li><p><strong>l_periodic</strong> (<em>boolean</em>) – Use periodicity in the calculations</p></li>
<li><p><strong>cell_par</strong> (<em>double</em><em>,</em><em>list</em>) – Cell lattice parameters (lengths and angles)</p></li>
<li><p><strong>xyz_file</strong> (<em>string</em>) – Initial tinker.xyz file</p></li>
<li><p><strong>key_file</strong> (<em>string</em>) – Initial tinker.key file</p></li>
<li><p><strong>mm_path</strong> (<em>string</em>) – Path for MM binary</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads in the calculations</p></li>
<li><p><strong>version</strong> (<em>string</em>) – Version of Tinker</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mm.tinker.Tinker.extract_MM">
<span class="sig-name descname"><span class="pre">extract_MM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mm.tinker.Tinker.extract_MM" title="Permalink to this definition"></a></dt>
<dd><p>Read the output files to get MM information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mm.tinker.Tinker.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_force_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mm.tinker.Tinker.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Extract energy and gradient from Tinker</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>calc_force_only</strong> (<em>boolean</em>) – Logical to decide whether calculate force only</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mm.tinker.Tinker.get_input">
<span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mm.tinker.Tinker.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Generate Tinker input files: tinker.xyz, tinker.key</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mm.tinker.Tinker.run_MM">
<span class="sig-name descname"><span class="pre">run_MM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mm.tinker.Tinker.run_MM" title="Permalink to this definition"></a></dt>
<dd><p>Run Tinker calculation and save the output files to mm_log directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>string</em>) – Base directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="mqc">
<h2>mqc<a class="headerlink" href="#mqc" title="Permalink to this heading"></a></h2>
<section id="module-mqc.mqc">
<span id="mqc-py"></span><h3>mqc.py<a class="headerlink" href="#module-mqc.mqc" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mqc.mqc.MQC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mqc.mqc.</span></span><span class="sig-name descname"><span class="pre">MQC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermostat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_print_dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_adj_nac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for nuclear/electronic propagator used in MQC dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>thermostat</strong> (<em>object</em>) – Thermostat type</p></li>
<li><p><strong>istate</strong> (<em>integer</em>) – Initial adiabatic state</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>nsteps</strong> (<em>integer</em>) – Nuclear step</p></li>
<li><p><strong>nesteps</strong> (<em>integer</em>) – Electronic step</p></li>
<li><p><strong>elec_object</strong> (<em>string</em>) – Electronic equation of motions</p></li>
<li><p><strong>propagator</strong> (<em>string</em>) – Electronic propagator</p></li>
<li><p><strong>l_print_dm</strong> (<em>boolean</em>) – Logical to print BO population and coherence</p></li>
<li><p><strong>l_adj_nac</strong> (<em>boolean</em>) – Logical to adjust nonadiabatic coupling</p></li>
<li><p><strong>init_coef</strong> (<em>Double</em><em>, </em><em>list</em><em> or </em><em>complex</em><em>, </em><em>list</em>) – Initial BO coefficient</p></li>
<li><p><strong>unit_dt</strong> (<em>string</em>) – Unit of time step (fs = femtosecond, au = atomic unit)</p></li>
<li><p><strong>out_freq</strong> (<em>integer</em>) – Frequency of printing output</p></li>
<li><p><strong>verbosity</strong> (<em>integer</em>) – Verbosity of output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.calculate_force">
<span class="sig-name descname"><span class="pre">calculate_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.calculate_force" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate the forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.check_qmmm">
<span class="sig-name descname"><span class="pre">check_qmmm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.check_qmmm" title="Permalink to this definition"></a></dt>
<dd><p>Routine to check compatibility between QM and MM objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.cl_update_position">
<span class="sig-name descname"><span class="pre">cl_update_position</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.cl_update_position" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update nuclear positions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.cl_update_velocity">
<span class="sig-name descname"><span class="pre">cl_update_velocity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.cl_update_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update nuclear velocities</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print the initial information of dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.run_init">
<span class="sig-name descname"><span class="pre">run_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_qm_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_mm_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_scr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.run_init" title="Permalink to this definition"></a></dt>
<dd><p>Initialize MQC dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>output_dir</strong> (<em>string</em>) – Location of input directory</p></li>
<li><p><strong>l_save_qm_log</strong> (<em>boolean</em>) – Logical for saving QM calculation log</p></li>
<li><p><strong>l_save_mm_log</strong> (<em>boolean</em>) – Logical for saving MM calculation log</p></li>
<li><p><strong>l_save_scr</strong> (<em>boolean</em>) – Logical for saving scratch directory</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.touch_file">
<span class="sig-name descname"><span class="pre">touch_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.touch_file" title="Permalink to this definition"></a></dt>
<dd><p>Routine to write PyUNIxMD output files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unixmd_dir</strong> (<em>string</em>) – Directory where MD output files are written</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.update_potential">
<span class="sig-name descname"><span class="pre">update_potential</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.update_potential" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update the potential of molecules</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.write_final_xyz">
<span class="sig-name descname"><span class="pre">write_final_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.write_final_xyz" title="Permalink to this definition"></a></dt>
<dd><p>Write final positions and velocities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – Directory where MD output files are written</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.mqc.MQC.write_md_output">
<span class="sig-name descname"><span class="pre">write_md_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.mqc.MQC.write_md_output" title="Permalink to this definition"></a></dt>
<dd><p>Write output files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – Directory where MD output files are written</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mqc.bomd">
<span id="bomd-py"></span><h3>bomd.py<a class="headerlink" href="#module-mqc.bomd" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mqc.bomd.BOMD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mqc.bomd.</span></span><span class="sig-name descname"><span class="pre">BOMD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermostat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.bomd.BOMD" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mqc.mqc.MQC" title="mqc.mqc.MQC"><code class="xref py py-class docutils literal notranslate"><span class="pre">MQC</span></code></a></p>
<p>Class for born-oppenheimer molecular dynamics (BOMD)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>thermostat</strong> (<em>object</em>) – Thermostat object</p></li>
<li><p><strong>istate</strong> (<em>integer</em>) – Electronic state</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>nsteps</strong> (<em>integer</em>) – Total step of nuclear propagation</p></li>
<li><p><strong>unit_dt</strong> (<em>string</em>) – Unit of time step</p></li>
<li><p><strong>out_freq</strong> (<em>integer</em>) – Frequency of printing output</p></li>
<li><p><strong>verbosity</strong> (<em>integer</em>) – Verbosity of output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mqc.bomd.BOMD.calculate_force">
<span class="sig-name descname"><span class="pre">calculate_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.bomd.BOMD.calculate_force" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate the forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.bomd.BOMD.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.bomd.BOMD.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print the initial information of dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.bomd.BOMD.print_step">
<span class="sig-name descname"><span class="pre">print_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.bomd.BOMD.print_step" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print each steps infomation about dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.bomd.BOMD.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_qm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_mm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_scr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.bomd.BOMD.run" title="Permalink to this definition"></a></dt>
<dd><p>Run MQC dynamics according to BOMD</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>output_dir</strong> (<em>string</em>) – Name of directory where outputs to be saved.</p></li>
<li><p><strong>l_save_qm_log</strong> (<em>boolean</em>) – Logical for saving QM calculation log</p></li>
<li><p><strong>l_save_mm_log</strong> (<em>boolean</em>) – Logical for saving MM calculation log</p></li>
<li><p><strong>l_save_scr</strong> (<em>boolean</em>) – Logical for saving scratch directory</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.bomd.BOMD.update_energy">
<span class="sig-name descname"><span class="pre">update_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.bomd.BOMD.update_energy" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update the energy of molecules in BOMD</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mqc.ct">
<span id="ct-py"></span><h3>ct.py<a class="headerlink" href="#module-mqc.ct" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mqc.ct.CT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mqc.ct.</span></span><span class="sig-name descname"><span class="pre">CT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermostat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_object</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coefficient'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rk4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_print_dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_adj_nac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_coefs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_dist_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_center_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_en_cons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mqc.mqc.MQC" title="mqc.mqc.MQC"><code class="xref py py-class docutils literal notranslate"><span class="pre">MQC</span></code></a></p>
<p>Class for coupled-trajectory mixed quantum-classical (CTMQC) dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecules</strong> (<em>object</em><em>,</em><em>list</em>) – List for molecule objects</p></li>
<li><p><strong>thermostat</strong> (<em>object</em>) – Thermostat object</p></li>
<li><p><strong>istates</strong> (<em>integer</em><em>,</em><em>list</em>) – List for initial state</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>nsteps</strong> (<em>integer</em>) – Total step of nuclear propagation</p></li>
<li><p><strong>nesteps</strong> (<em>integer</em>) – Total step of electronic propagation</p></li>
<li><p><strong>elec_object</strong> (<em>string</em>) – Electronic equation of motions</p></li>
<li><p><strong>propagator</strong> (<em>string</em>) – Electronic propagator</p></li>
<li><p><strong>l_print_dm</strong> (<em>boolean</em>) – Logical to print BO population and coherence</p></li>
<li><p><strong>l_adj_nac</strong> (<em>boolean</em>) – Adjust nonadiabatic coupling to align the phases</p></li>
<li><p><strong>rho_threshold</strong> (<em>double</em>) – Electronic density threshold for decoherence term calculation</p></li>
<li><p><strong>init_coefs</strong> (<em>double</em><em>, </em><em>2D list</em><em> or </em><em>complex</em><em>, </em><em>2D list</em>) – Initial BO coefficient</p></li>
<li><p><strong>dist_parameter</strong> (<em>double</em>) – Distance parameter to contruct Gaussian and determine quantum momentum center</p></li>
<li><p><strong>min_sigma</strong> (<em>double</em>) – Minimum sigma value</p></li>
<li><p><strong>const_dist_cutoff</strong> (<em>double</em>) – Distance cutoff to construct Gaussian</p></li>
<li><p><strong>const_center_cutoff</strong> (<em>double</em>) – Distance cutoff to determine quantum momentum center</p></li>
<li><p><strong>unit_dt</strong> (<em>string</em>) – Unit of time interval</p></li>
<li><p><strong>out_freq</strong> (<em>integer</em>) – Frequency of printing output</p></li>
<li><p><strong>verbosity</strong> (<em>integer</em>) – Verbosity of output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.calculate_center">
<span class="sig-name descname"><span class="pre">calculate_center</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.calculate_center" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate center of quantum momentum</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.calculate_force">
<span class="sig-name descname"><span class="pre">calculate_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itrajectory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.calculate_force" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate force</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>itrajectory</strong> (<em>integer</em>) – Index for trajectories</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.calculate_qmom">
<span class="sig-name descname"><span class="pre">calculate_qmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.calculate_qmom" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate quantum momentum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.calculate_sigma">
<span class="sig-name descname"><span class="pre">calculate_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.calculate_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate variances for each trajectories</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.calculate_slope">
<span class="sig-name descname"><span class="pre">calculate_slope</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.calculate_slope" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate slope</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.check_decoherence">
<span class="sig-name descname"><span class="pre">check_decoherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itrajectory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.check_decoherence" title="Permalink to this definition"></a></dt>
<dd><p>Routine to check decoherence among BO states</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>itrajectory</strong> (<em>integer</em>) – Index for trajectories</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.check_istates">
<span class="sig-name descname"><span class="pre">check_istates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.check_istates" title="Permalink to this definition"></a></dt>
<dd><p>Routine to check istates and init_coefs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.get_phase">
<span class="sig-name descname"><span class="pre">get_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itrajectory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.get_phase" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>itrajectory</strong> (<em>integer</em>) – Index for trajectories</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print the initial information of dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.print_step">
<span class="sig-name descname"><span class="pre">print_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itrajectory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.print_step" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print each trajectory infomation at each step about dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
<li><p><strong>itrajectory</strong> (<em>integer</em>) – Current trajectory</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_qm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_mm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_scr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.run" title="Permalink to this definition"></a></dt>
<dd><p>Run MQC dynamics according to CTMQC dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>output_dir</strong> (<em>string</em>) – Name of directory where outputs to be saved.</p></li>
<li><p><strong>l_save_qm_log</strong> (<em>boolean</em>) – Logical for saving QM calculation log</p></li>
<li><p><strong>l_save_mm_log</strong> (<em>boolean</em>) – Logical for saving MM calculation log</p></li>
<li><p><strong>l_save_scr</strong> (<em>boolean</em>) – Logical for saving scratch directory</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.set_decoherence">
<span class="sig-name descname"><span class="pre">set_decoherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_st</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.set_decoherence" title="Permalink to this definition"></a></dt>
<dd><p>Routine to reset coefficient/density if the state is decohered</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>one_st</strong> (<em>integer</em>) – State index that its population is one</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.update_energy">
<span class="sig-name descname"><span class="pre">update_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.update_energy" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update the energy of molecules in CTMQC dynamics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.write_dec">
<span class="sig-name descname"><span class="pre">write_dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itrajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.write_dec" title="Permalink to this definition"></a></dt>
<dd><p>Write CT-based decoherence information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>itrajectory</strong> (<em>integer</em>) – Index for trajectories</p></li>
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.write_dotpop">
<span class="sig-name descname"><span class="pre">write_dotpop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itrajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.write_dotpop" title="Permalink to this definition"></a></dt>
<dd><p>Write time-derivative BO population</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>itrajectory</strong> (<em>integer</em>) – Index for trajectories</p></li>
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.ct.CT.write_md_output">
<span class="sig-name descname"><span class="pre">write_md_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itrajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.ct.CT.write_md_output" title="Permalink to this definition"></a></dt>
<dd><p>Write output files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>itrajectory</strong> (<em>integer</em>) – Index for trajectories</p></li>
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mqc.eh">
<span id="eh-py"></span><h3>eh.py<a class="headerlink" href="#module-mqc.eh" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mqc.eh.Eh">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mqc.eh.</span></span><span class="sig-name descname"><span class="pre">Eh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermostat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_object</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'density'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rk4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_print_dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_adj_nac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.eh.Eh" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mqc.mqc.MQC" title="mqc.mqc.MQC"><code class="xref py py-class docutils literal notranslate"><span class="pre">MQC</span></code></a></p>
<p>Class for Ehrenfest dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>thermostat</strong> (<em>object</em>) – Thermostat object</p></li>
<li><p><strong>istate</strong> (<em>integer</em>) – Initial state</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>nsteps</strong> (<em>integer</em>) – Total step of nuclear propation</p></li>
<li><p><strong>nesteps</strong> (<em>integer</em>) – Total step of electronic propagation</p></li>
<li><p><strong>elec_object</strong> (<em>string</em>) – Electronic equation of motions</p></li>
<li><p><strong>propagator</strong> (<em>string</em>) – Electronic propagator</p></li>
<li><p><strong>l_print_dm</strong> (<em>boolean</em>) – Logical to print BO population and coherence</p></li>
<li><p><strong>l_adj_nac</strong> (<em>boolean</em>) – Logical to adjust nonadiabatic coupling</p></li>
<li><p><strong>init_coef</strong> (<em>Double</em><em>, </em><em>list</em><em> or </em><em>complex</em><em>, </em><em>list</em>) – Initial BO coefficient</p></li>
<li><p><strong>unit_dt</strong> (<em>string</em>) – Unit of time step (fs = femtosecond, au = atomic unit)</p></li>
<li><p><strong>out_freq</strong> (<em>integer</em>) – Frequency of printing output</p></li>
<li><p><strong>verbosity</strong> (<em>integer</em>) – Verbosity of output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mqc.eh.Eh.calculate_force">
<span class="sig-name descname"><span class="pre">calculate_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.eh.Eh.calculate_force" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Ehrenfest force</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.eh.Eh.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.eh.Eh.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print the initial information of dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.eh.Eh.print_step">
<span class="sig-name descname"><span class="pre">print_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.eh.Eh.print_step" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print each steps infomation about dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.eh.Eh.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_qm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_mm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_scr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.eh.Eh.run" title="Permalink to this definition"></a></dt>
<dd><p>Run MQC dynamics according to Ehrenfest dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>output_dir</strong> (<em>string</em>) – Name of directory where outputs to be saved.</p></li>
<li><p><strong>l_save_qm_log</strong> (<em>boolean</em>) – Logical for saving QM calculation log</p></li>
<li><p><strong>l_save_mm_log</strong> (<em>boolean</em>) – Logical for saving MM calculation log</p></li>
<li><p><strong>l_save_scr</strong> (<em>boolean</em>) – Logical for saving scratch directory</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.eh.Eh.update_energy">
<span class="sig-name descname"><span class="pre">update_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.eh.Eh.update_energy" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update the energy of molecules in Ehrenfest dynamics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.eh.Eh.write_dotpop">
<span class="sig-name descname"><span class="pre">write_dotpop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.eh.Eh.write_dotpop" title="Permalink to this definition"></a></dt>
<dd><p>Write time-derivative BO population</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.eh.Eh.write_md_output">
<span class="sig-name descname"><span class="pre">write_md_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.eh.Eh.write_md_output" title="Permalink to this definition"></a></dt>
<dd><p>Write output files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mqc.sh">
<span id="sh-py"></span><h3>sh.py<a class="headerlink" href="#module-mqc.sh" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mqc.sh.SH">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mqc.sh.</span></span><span class="sig-name descname"><span class="pre">SH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermostat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_object</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'density'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rk4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_print_dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_adj_nac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'augment'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_reject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reverse'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edc_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mqc.mqc.MQC" title="mqc.mqc.MQC"><code class="xref py py-class docutils literal notranslate"><span class="pre">MQC</span></code></a></p>
<p>Class for surface hopping dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>thermostat</strong> (<em>object</em>) – Thermostat object</p></li>
<li><p><strong>istate</strong> (<em>integer</em>) – Initial state</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>nsteps</strong> (<em>integer</em>) – Total step of nuclear propagation</p></li>
<li><p><strong>nesteps</strong> (<em>integer</em>) – Total step of electronic propagation</p></li>
<li><p><strong>elec_object</strong> (<em>string</em>) – Electronic equation of motions</p></li>
<li><p><strong>propagator</strong> (<em>string</em>) – Electronic propagator</p></li>
<li><p><strong>l_print_dm</strong> (<em>boolean</em>) – Logical to print BO population and coherence</p></li>
<li><p><strong>l_adj_nac</strong> (<em>boolean</em>) – Adjust nonadiabatic coupling to align the phases</p></li>
<li><p><strong>hop_rescale</strong> (<em>string</em>) – Velocity rescaling method after successful hop</p></li>
<li><p><strong>hop_reject</strong> (<em>string</em>) – Velocity rescaling method after frustrated hop</p></li>
<li><p><strong>init_coef</strong> (<em>double</em><em>, </em><em>list</em><em> or </em><em>complex</em><em>, </em><em>list</em>) – Initial BO coefficient</p></li>
<li><p><strong>dec_correction</strong> (<em>string</em>) – Simple decoherence correction schemes</p></li>
<li><p><strong>edc_parameter</strong> (<em>double</em>) – Energy constant (H) for rescaling coefficients in edc</p></li>
<li><p><strong>unit_dt</strong> (<em>string</em>) – Unit of time step</p></li>
<li><p><strong>out_freq</strong> (<em>integer</em>) – Frequency of printing output</p></li>
<li><p><strong>verbosity</strong> (<em>integer</em>) – Verbosity of output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.calculate_force">
<span class="sig-name descname"><span class="pre">calculate_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.calculate_force" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate the forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.correct_dec_edc">
<span class="sig-name descname"><span class="pre">correct_dec_edc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.correct_dec_edc" title="Permalink to this definition"></a></dt>
<dd><p>Routine to decoherence correction, energy-based decoherence correction(EDC) scheme</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.correct_dec_idc">
<span class="sig-name descname"><span class="pre">correct_dec_idc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.correct_dec_idc" title="Permalink to this definition"></a></dt>
<dd><p>Routine to decoherence correction, instantaneous decoherence correction(IDC) scheme</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.evaluate_hop">
<span class="sig-name descname"><span class="pre">evaluate_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.evaluate_hop" title="Permalink to this definition"></a></dt>
<dd><p>Routine to evaluate hopping and velocity rescaling</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.hop_check">
<span class="sig-name descname"><span class="pre">hop_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.hop_check" title="Permalink to this definition"></a></dt>
<dd><p>Routine to check hopping occurs with random number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.hop_prob">
<span class="sig-name descname"><span class="pre">hop_prob</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.hop_prob" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate hopping probabilities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print the initial information of dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.print_step">
<span class="sig-name descname"><span class="pre">print_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.print_step" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print each steps infomation about dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_qm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_mm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_scr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.run" title="Permalink to this definition"></a></dt>
<dd><p>Run MQC dynamics according to surface hopping dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>output_dir</strong> (<em>string</em>) – Name of directory where outputs to be saved.</p></li>
<li><p><strong>l_save_qm_log</strong> (<em>boolean</em>) – Logical for saving QM calculation log</p></li>
<li><p><strong>l_save_mm_log</strong> (<em>boolean</em>) – Logical for saving MM calculation log</p></li>
<li><p><strong>l_save_scr</strong> (<em>boolean</em>) – Logical for saving scratch directory</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.update_energy">
<span class="sig-name descname"><span class="pre">update_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.update_energy" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update the energy of molecules in surface hopping dynamics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.write_dotpop">
<span class="sig-name descname"><span class="pre">write_dotpop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.write_dotpop" title="Permalink to this definition"></a></dt>
<dd><p>Write time-derivative BO population</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.write_md_output">
<span class="sig-name descname"><span class="pre">write_md_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.write_md_output" title="Permalink to this definition"></a></dt>
<dd><p>Write output files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.sh.SH.write_sh">
<span class="sig-name descname"><span class="pre">write_sh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.sh.SH.write_sh" title="Permalink to this definition"></a></dt>
<dd><p>Write hopping-related quantities into files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mqc.shxf">
<span id="shxf-py"></span><h3>shxf.py<a class="headerlink" href="#module-mqc.shxf" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mqc.shxf.Auxiliary_Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mqc.shxf.</span></span><span class="sig-name descname"><span class="pre">Auxiliary_Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.Auxiliary_Molecule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for auxiliary molecule that is used for the calculation of decoherence term</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mqc.shxf.SHXF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mqc.shxf.</span></span><span class="sig-name descname"><span class="pre">SHXF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermostat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_object</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'density'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rk4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_print_dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_adj_nac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'augment'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_reject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reverse'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_econs_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aux_econs_viol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mqc.mqc.MQC" title="mqc.mqc.MQC"><code class="xref py py-class docutils literal notranslate"><span class="pre">MQC</span></code></a></p>
<p>Class for DISH-XF dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>object</em>) – Molecule object</p></li>
<li><p><strong>thermostat</strong> (<em>object</em>) – Thermostat object</p></li>
<li><p><strong>istate</strong> (<em>integer</em>) – Initial state</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time interval</p></li>
<li><p><strong>nsteps</strong> (<em>integer</em>) – Total step of nuclear propagation</p></li>
<li><p><strong>nesteps</strong> (<em>integer</em>) – Total step of electronic propagation</p></li>
<li><p><strong>elec_object</strong> (<em>string</em>) – Electronic equation of motions</p></li>
<li><p><strong>propagator</strong> (<em>string</em>) – Electronic propagator</p></li>
<li><p><strong>l_print_dm</strong> (<em>boolean</em>) – Logical to print BO population and coherence</p></li>
<li><p><strong>l_adj_nac</strong> (<em>boolean</em>) – Adjust nonadiabatic coupling to align the phases</p></li>
<li><p><strong>hop_rescale</strong> (<em>string</em>) – Velocity rescaling method after successful hop</p></li>
<li><p><strong>hop_reject</strong> (<em>string</em>) – Velocity rescaling method after frustrated hop</p></li>
<li><p><strong>rho_threshold</strong> (<em>double</em>) – Electronic density threshold for decoherence term calculation</p></li>
<li><p><strong>sigma</strong> (<em>double</em><em> or </em><em>double</em><em>,</em><em>list</em>) – Width of nuclear wave packet of auxiliary trajectory</p></li>
<li><p><strong>init_coef</strong> (<em>double</em><em>, </em><em>list</em><em> or </em><em>complex</em><em>, </em><em>list</em>) – Initial BO coefficient</p></li>
<li><p><strong>l_econs_state</strong> (<em>boolean</em>) – Logical to use identical total energies for all auxiliary trajectories</p></li>
<li><p><strong>aux_econs_viol</strong> (<em>string</em>) – How to treat trajectories violating the total energy conservation</p></li>
<li><p><strong>unit_dt</strong> (<em>string</em>) – Unit of time interval</p></li>
<li><p><strong>out_freq</strong> (<em>integer</em>) – Frequency of printing output</p></li>
<li><p><strong>verbosity</strong> (<em>integer</em>) – Verbosity of output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.append_sigma">
<span class="sig-name descname"><span class="pre">append_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.append_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Routine to append sigma values when single float number is provided</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.aux_propagator">
<span class="sig-name descname"><span class="pre">aux_propagator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.aux_propagator" title="Permalink to this definition"></a></dt>
<dd><p>Routine to propagate auxiliary molecule</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.calculate_force">
<span class="sig-name descname"><span class="pre">calculate_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.calculate_force" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate the forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.check_coherence">
<span class="sig-name descname"><span class="pre">check_coherence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.check_coherence" title="Permalink to this definition"></a></dt>
<dd><p>Routine to check coherence among BO states</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.check_decoherence">
<span class="sig-name descname"><span class="pre">check_decoherence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.check_decoherence" title="Permalink to this definition"></a></dt>
<dd><p>Routine to check if the electronic state is decohered</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.collapse">
<span class="sig-name descname"><span class="pre">collapse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cstate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.collapse" title="Permalink to this definition"></a></dt>
<dd><p>Routine to collapse coefficient/density of a state to zero</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.evaluate_hop">
<span class="sig-name descname"><span class="pre">evaluate_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.evaluate_hop" title="Permalink to this definition"></a></dt>
<dd><p>Routine to evaluate hopping and velocity rescaling</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.get_phase">
<span class="sig-name descname"><span class="pre">get_phase</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.get_phase" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate phase term</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.hop_check">
<span class="sig-name descname"><span class="pre">hop_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bo_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.hop_check" title="Permalink to this definition"></a></dt>
<dd><p>Routine to check hopping occurs with random number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bo_list</strong> (<em>integer</em><em>,</em><em>list</em>) – List of BO states for BO calculation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.hop_prob">
<span class="sig-name descname"><span class="pre">hop_prob</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.hop_prob" title="Permalink to this definition"></a></dt>
<dd><p>Routine to calculate hopping probabilities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.print_init">
<span class="sig-name descname"><span class="pre">print_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.print_init" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print the initial information of dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.print_step">
<span class="sig-name descname"><span class="pre">print_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.print_step" title="Permalink to this definition"></a></dt>
<dd><p>Routine to print each steps infomation about dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_qm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_mm_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_save_scr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.run" title="Permalink to this definition"></a></dt>
<dd><p>Run MQC dynamics according to decoherence-induced surface hopping dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm</strong> (<em>object</em>) – QM object containing on-the-fly calculation infomation</p></li>
<li><p><strong>mm</strong> (<em>object</em>) – MM object containing MM calculation infomation</p></li>
<li><p><strong>output_dir</strong> (<em>string</em>) – Name of directory where outputs to be saved.</p></li>
<li><p><strong>l_save_qm_log</strong> (<em>boolean</em>) – Logical for saving QM calculation log</p></li>
<li><p><strong>l_save_mm_log</strong> (<em>boolean</em>) – Logical for saving MM calculation log</p></li>
<li><p><strong>l_save_scr</strong> (<em>boolean</em>) – Logical for saving scratch directory</p></li>
<li><p><strong>restart</strong> (<em>string</em>) – Option for controlling dynamics restarting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.set_decoherence">
<span class="sig-name descname"><span class="pre">set_decoherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_st</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.set_decoherence" title="Permalink to this definition"></a></dt>
<dd><p>Routine to reset coefficient/density if the state is decohered</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>one_st</strong> (<em>integer</em>) – State index that its population is one</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.update_energy">
<span class="sig-name descname"><span class="pre">update_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.update_energy" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update the energy of molecules in surface hopping dynamics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.write_dec">
<span class="sig-name descname"><span class="pre">write_dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.write_dec" title="Permalink to this definition"></a></dt>
<dd><p>Write XF-based decoherence information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.write_dotpop">
<span class="sig-name descname"><span class="pre">write_dotpop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.write_dotpop" title="Permalink to this definition"></a></dt>
<dd><p>Write time-derivative BO population</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.write_md_output">
<span class="sig-name descname"><span class="pre">write_md_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.write_md_output" title="Permalink to this definition"></a></dt>
<dd><p>Write output files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mqc.shxf.SHXF.write_sh">
<span class="sig-name descname"><span class="pre">write_sh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unixmd_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mqc.shxf.SHXF.write_sh" title="Permalink to this definition"></a></dt>
<dd><p>Write hopping-related quantities into files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unixmd_dir</strong> (<em>string</em>) – PyUNIxMD directory</p></li>
<li><p><strong>istep</strong> (<em>integer</em>) – Current MD step</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../objects/mqc/shxf.html" class="btn btn-neutral float-left" title="DISH-XF" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../utility_scripts.html" class="btn btn-neutral float-right" title="7. PyUNIxMD utility scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, mingroup.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>