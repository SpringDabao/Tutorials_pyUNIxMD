from molecule import Molecule
from thermostat import NHC
import qm, mqc
from misc import data, au_to_K

# Define the target system. these are positions and velocities.
geom = """
60

C     2.942310   -0.712570    1.818450   0.0 0.0 0.0      
C     2.942310    0.712570    1.818450   0.0 0.0 0.0
C     1.961540    1.425140    2.567690   0.0 0.0 0.0
C     1.586920    2.578100    1.818450   0.0 0.0 0.0
C     3.173830   -1.425140    0.606149   0.0 0.0 0.0
C     2.336160   -2.578100    0.606149   0.0 0.0 0.0
C     0.980769    0.712570    3.316930   0.0 0.0 0.0
C     0.980769   -0.712570    3.316930   0.0 0.0 0.0
C    -0.374620   -1.152960    3.316930   0.0 0.0 0.0
C     0.231528    3.018500    1.818450   0.0 0.0 0.0
C    -0.749241    2.305930    2.567690   0.0 0.0 0.0
C    -1.961540    2.305930    1.818450   0.0 0.0 0.0
C     3.405360   -0.712570   -0.606149   0.0 0.0 0.0
C     3.405360    0.712570   -0.606149   0.0 0.0 0.0
C     2.799210    1.152960   -1.818450   0.0 0.0 0.0
C     1.730010   -3.018500   -0.606149   0.0 0.0 0.0
C     1.961540   -2.305930   -1.818450   0.0 0.0 0.0
C     0.749241   -2.305930   -2.567690   0.0 0.0 0.0
C     2.336160    2.578100    0.606149   0.0 0.0 0.0
C     1.961540   -1.425140    2.567690   0.0 0.0 0.0
C    -0.749241   -2.305930    2.567690   0.0 0.0 0.0
C     0.231528   -3.018500    1.818450   0.0 0.0 0.0
C    -0.374620   -3.458890    0.606149   0.0 0.0 0.0
C     3.173830    1.425140    0.606149   0.0 0.0 0.0
C    -0.374620    1.152960    3.316930   0.0 0.0 0.0
C    -2.799210    1.152960    1.818450   0.0 0.0 0.0
C    -2.424590   -0.000000    2.567690   0.0 0.0 0.0
C    -2.799210   -1.152960    1.818450   0.0 0.0 0.0
C     1.586920   -2.578100    1.818450   0.0 0.0 0.0
C     1.961540    2.305930   -1.818450   0.0 0.0 0.0
C     1.730010    3.018500   -0.606149   0.0 0.0 0.0
C     0.374620    3.458890   -0.606149   0.0 0.0 0.0
C     2.799210   -1.152960   -1.818450   0.0 0.0 0.0
C     0.374620   -1.152960   -3.316930   0.0 0.0 0.0
C     1.212300    0.000000   -3.316930   0.0 0.0 0.0
C     0.374620    1.152960   -3.316930   0.0 0.0 0.0
C    -0.231528    3.018500   -1.818450   0.0 0.0 0.0
C    -1.212300    0.000000    3.316930   0.0 0.0 0.0
C     0.374620   -3.458890   -0.606149   0.0 0.0 0.0
C     2.424590   -0.000000   -2.567690   0.0 0.0 0.0
C    -1.730010    3.018500    0.606149   0.0 0.0 0.0
C    -0.374620    3.458890    0.606149   0.0 0.0 0.0
C    -1.961540   -2.305930    1.818450   0.0 0.0 0.0
C    -1.730010   -3.018500    0.606149   0.0 0.0 0.0
C    -0.231528   -3.018500   -1.818450   0.0 0.0 0.0
C     0.749241    2.305930   -2.567690   0.0 0.0 0.0
C    -1.586920    2.578100   -1.818450   0.0 0.0 0.0
C    -2.336160    2.578100   -0.606149   0.0 0.0 0.0
C    -3.173830    1.425140   -0.606149   0.0 0.0 0.0
C    -3.405360   -0.712570    0.606149   0.0 0.0 0.0
C    -0.980769    0.712570   -3.316930   0.0 0.0 0.0
C    -2.942310    0.712570   -1.818450   0.0 0.0 0.0
C    -3.405360    0.712570    0.606149   0.0 0.0 0.0
C    -2.336160   -2.578100   -0.606149   0.0 0.0 0.0
C    -1.586920   -2.578100   -1.818450   0.0 0.0 0.0
C    -1.961540   -1.425140   -2.567690   0.0 0.0 0.0
C    -2.942310   -0.712570   -1.818450   0.0 0.0 0.0
C    -0.980769   -0.712570   -3.316930   0.0 0.0 0.0
C    -3.173830   -1.425140   -0.606149   0.0 0.0 0.0
C    -1.961540    1.425140   -2.567690   0.0 0.0 0.0
"""
mol = Molecule(geometry=geom, nstates=1, charge=0.)

# Set QM method.
qm = qm.dftbplus.DFTB(molecule=mol, version="20.1", install_path="/projects/academic/cyberwksp21/Software/_install_dftb_20.2.1", sk_path="/projects/academic/cyberwksp21/Students/qingxin/UNIxMD/Tutorials_pyUNIxMD/demo_pyunixmd_dftb/mio-1-1/")

thermo = NHC(time_scale = 10.0, temperature=300.) # NHc meand Nose hoover chain

# Determine MD method.
md = mqc.BOMD(molecule=mol, thermostat=thermo, nsteps=20000, dt=1, istate=0)

# Execute the simulation.
md.run(qm=qm)
